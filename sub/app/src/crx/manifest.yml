#
# Manifest YML
# NOTE: We use YML to allow for comments, etc.
# grunt convert (to convert to JSON file).
#
# Manifest format
# https://developer.chrome.com/extensions/manifest
# https://developer.chrome.com/extensions/faq
# https://bugs.chromium.org/p/chromium/issues/list
#
# Tools
# grunt watch:crx
#
# Chrome extension:
# https://chrome.google.com/webstore/detail/extensions-reloader/fimgfedafeadlieiabdeeaodndnlbhid
# NOTE: On manifest changes, must reload via chrome://extensions
#

name:               Minder
short_name:         Minder
version:            0.1.0                           # grunt version:crx:patch (uses version.json)
author:             Minder Labs,
description:        Automated intelligence.
manifest_version:   2,

icons:
  128: "img/icon_128.png"

#
# Permissions.
# https://developer.chrome.com/extensions/declare_permissions
#

permissions:
  - background
  - contextMenus
  - identity
  - management
  - notifications
  - storage
  - tabs
  - gcm                                             # Cloud Messaging (FCM).

  - "http://localhost/*"
  - "http://local-docker-machine/*"

  - "*://minderlabs.com/*"

  - "<all_urls>"


#
# OAuth2
# Client ID generated in console:
# https://console.developers.google.com/apis/credentials?project=minder-beta
# https://developer.chrome.com/apps/app_identity#update_manifest
# https://developers.google.com/identity/protocols/googlescopes
#

oauth2:
  client_id: '189079594739-ngfnpmj856f7i0afsd6dka4712i0urij.apps.googleusercontent.com'
  scopes:
    - 'https://www.googleapis.com/auth/userinfo.profile'


#
# Content script.
# https://developer.chrome.com/extensions/content_scripts
#

content_scripts:
  -
    run_at: document_idle
    matches:
#     - "<all_urls>"

      - "http://localhost/testing/*"

      - "https://*.google.com/*"

    js:
      # NOTE: Cannot be symlink.
      # https://bugs.chromium.org/p/chromium/issues/detail?id=27185&q=burdon&colspec=ID%20Pri%20M%20Stars%20ReleaseBlock%20Component%20Status%20Owner%20Summary%20OS%20Modified
      - "assets/content_script.bundle.js"

    css:
      - "assets/content_script.css"

#
# Content Security Policy (CSP)
# https://developer.chrome.com/extensions/contentSecurityPolicy
# http://www.html5rocks.com/en/tutorials/security/content-security-policy
# https://w3c.github.io/webappsec-csp
# TODO(burdon): Document why unsafe-eval is needed.
#
# Firebase API:
# https://github.com/firebase/quickstart-js/tree/master/auth/chromextension
#

content_security_policy: "script-src 'self' 'unsafe-eval' https://www.gstatic.com https://*.firebaseio.com https://www.googleapis.com https://minderlabs.com https://apis.google.com; object-src 'self'"

#
# https://developer.chrome.com/extensions/manifest/externally_connectable
#

externally_connectable:
  ids:
    - '*'

#
# White list for context script resources.
# https://developer.chrome.com/extensions/manifest/web_accessible_resources
# Accessible via: chrome-extension://ID/PATH
#

web_accessible_resources:
  - "assets/*"
  - "page/*"
  - "img/*"
